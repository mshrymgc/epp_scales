<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="robots" content="noindex, nofollow" />
  <title>EYES TEST - ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³</title>
  <link rel="stylesheet" href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css" />
  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, 'Hiragino Kaku Gothic ProN', 'Yu Gothic', 'Noto Sans JP', sans-serif;
      background: linear-gradient(135deg, #f5f5f7 0%, #ffffff 100%);
    }
    .jspsych-content {
      max-width: 900px;
      margin: 0 auto;
    }
    .card {
      background: #ffffff;
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    h1 {
      color: #1d1d1f;
      font-size: 1.8rem;
      margin: 0 0 1rem 0;
      font-weight: 700;
      text-align: center;
    }
    h2 {
      color: #0071e3;
      font-size: 1.3rem;
      margin-top: 1.5rem;
      margin-bottom: 0.8rem;
      font-weight: 600;
    }
    .jspsych-btn {
      background-color: #0071e3;
      color: #fff;
      border: 1px solid #0071e3;
      padding: 0.6rem 1.2rem;
      margin: 0.5rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.2s ease;
    }
    .jspsych-btn:hover {
      background-color: #0059b3;
      border-color: #0059b3;
    }
    .status-bar {
      display: none;
    }
    .status-item {
      text-align: center;
    }
    .status-label {
      font-size: 0.85rem;
      color: #666;
      margin-bottom: 0.3rem;
    }
    .status-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: #1d1d1f;
    }
    .result-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin: 1.5rem 0;
    }
    .result-item {
      background: #f5f5f7;
      padding: 1rem;
      border-radius: 8px;
      text-align: center;
    }
    .result-label {
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 0.5rem;
    }
    .result-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: #1d1d1f;
    }
    .result-value.positive {
      color: #34c759;
    }
    .result-value.negative {
      color: #ff3b30;
    }
    .word-definitions {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      margin-top: 2rem;
      padding: 1.5rem 0 0 0;
      border-top: 1px solid #e0e0e0;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }
    .definition-item {
      padding: 0.75rem;
      background: #f9f9f9;
      border-left: 3px solid #0071e3;
      border-radius: 4px;
      font-size: 0.85rem;
      line-height: 1.4;
    }
    .definition-word {
      font-weight: 600;
      color: #0071e3;
      display: block;
      margin-bottom: 0.3rem;
    }
    .definition-text {
      color: #555;
    }
  </style>
</head>
<body>
  <div id="jspsych-target"></div>
  <script src="https://unpkg.com/jspsych@7.3.4"></script>
  <script src="https://unpkg.com/@jspsych/plugin-html-button-response@1.1.2"></script>
  <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe@0.5.0/dist/index.browser.min.js"></script>
  <script>
(() => {
  // è¨€è‘‰ã®èª¬æ˜æ–‡è¾æ›¸
  const wordDefinitions = {
    "å“€é¡˜ã—ã¦ã„ã‚‹": "åˆ‡ã«é¡˜ã„é ¼ã‚€ã€‚ç›¸æ‰‹ã®åŒæƒ…å¿ƒã«è¨´ãˆã¦é ¼ã‚€ã€‚",
    "æ„›æƒ…ã‚’æŒã£ã¦ã„ã‚‹": "äººã‚„ç‰©ã‚’å¿ƒã‹ã‚‰å¤§åˆ‡ã«æ€ã†ã‚ãŸãŸã‹ã„æ°—æŒã¡ã‚’æŒã£ã¦ã„ã‚‹ã€‚ç•°æ€§ã‚’æ‹ã—ãæ€ã†å¿ƒã‚’æŒã£ã¦ã„ã‚‹ã€‚",
    "å®‰å¿ƒã•ã›ã‚ˆã†ã¨ã—ã¦ã„ã‚‹": "å¿ƒãŒå®‰ã‚‰ã‹ã«è½ã¡ç€ã‹ã›ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã€‚ä¸å®‰ã‚„å¿ƒé…ã‚’ãªãã•ã›ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã€‚",
    "ã„ã‚‰ã ã£ã¦ã„ã‚‹": "æ€ã„ã©ãŠã‚Šã«ãªã‚‰ãªãã¦è½ã¡ç€ã‹ãªã„æ§˜å­ã€‚ã„ã‚‰ã„ã‚‰ã—ã¦ã„ã‚‹ã€‚",
    "ç–‘ã„ã‚’æŠ±ã„ã¦ã„ã‚‹": "ç–‘ã„ã€æ€ªã—ã¿ã€ä¸å¯©ã€ç–‘å¿µã‚’å¿ƒã®ä¸­ã«æŒã£ã¦ã„ã‚‹ã€‚",
    "ç–‘ã£ã¦ã„ã‚‹": "ç–‘ã†ã“ã¨ã€‚æ€ªã—ã‚€ã“ã¨ã€‚ä¸å¯©ã€‚ç–‘å¿µã€‚",
    "ã†ã‚“ã–ã‚Šã—ã¦ã„ã‚‹": "ã™ã£ã‹ã‚Šé£½ãã¦ã„ã‚„ã«ãªã‚‹ã•ã¾ã€‚",
    "ã†ã‚ãŸãˆã¦ã„ã‚‹": "äºˆæƒ³å¤–ã®äº‹æ…‹ã«ã©ã†ã—ã¦ã‚ˆã„ã‹ã‚ã‹ã‚‰ãšã€ã¾ã”ã¾ã”ã™ã‚‹ã€‚",
    "æ¨ªæŸ„ãªæ°—åˆ†ã§ã‚ã‚‹": "äººã‚’è¦‹ä¸‹ã—ãŸã‚ˆã†ãªãˆã‚‰ãã†ãªæ…‹åº¦ã‚’ã¨ã‚‹ã•ã¾ã€‚",
    "è½ã¡ç€ã‹ãªã„æ°—æŒã¡ã§ã„ã‚‹": "å‹•æºãŒé™ã¾ã‚Šã€å®‰å®šã—ãŸçŠ¶æ…‹ã«ãªã‚‹ã€‚äººã®æ…‹åº¦ã‚„è¨€å‹•ãŒç©ã‚„ã‹ã§å†·é™ã§ã‚ã‚‹ã€‚",
    "è½ã¡è¾¼ã‚“ã§ã„ã‚‹": "æ°—åˆ†ãŒã‚ã„ã‚‹çŠ¶æ…‹ã€‚",
    "è„…ã—ã¦ã„ã‚‹": "æã‚Œã•ã›ã¦è‡ªåˆ†ã«å¾“ã‚ã›ã‚ˆã†ã¨ã™ã‚‹ã€‚ã¾ãŸã€ã“ã‚ãŒã‚‰ã›ã‚‹ã€‚",
    "ãŠã©ã‘ã¦ã„ã‚‹": "æ»‘ç¨½ãªã“ã¨ã‚’è¨€ã£ãŸã‚Šã€ã—ãŸã‚Šã™ã‚‹ã€‚ãµã–ã‘ã¦ã„ã‚‹ã€‚",
    "ãŠã³ãˆã¦ã„ã‚‹": "æ€–ãŒã£ã¦ã³ãã³ãã™ã‚‹ã€‚ã¾ãŸã€æã‚ã—ãã¦å£°ã‚’ãŸã¦ã‚‹ã€‚",
    "é¢ç™½ãŒã£ã¦ã„ã‚‹": "æ¥½ã—ã„ã€‚æ„‰å¿«ã ã€‚èˆˆå‘³ã‚’ããã‚‹ã€‚èˆˆå‘³æ·±ã„ã€‚ã“ã£ã‘ã„ã ã€‚ãŠã‹ã—ã„ã€‚å¿ƒã‚’ã²ã‹ã‚Œã‚‹ã€‚è¶£ãŒæ·±ã„ã€‚é¢¨æµã ã€‚",
    "ãŒã£ã‹ã‚Šã—ã¦ã„ã‚‹": "äº‹ãŒæ€ã„ã©ãŠã‚Šã«ã„ã‹ãšã€æ°—è½ã¡ã—ã¦ã„ã‚‹ã•ã¾ã€‚",
    "è€ƒãˆã«ãµã‘ã£ã¦ã„ã‚‹": "ã‚ã‚‹ä¸€ã¤ã®è€ƒãˆã«å¤¢ä¸­ã«ãªã£ã¦ã„ã‚‹ã•ã¾ã€‚",
    "æ„Ÿè¬ã—ã¦ã„ã‚‹": "ã‚ã‚ŠãŒãŸã„ã¨æ€ã£ã¦ã„ã‚‹ã€‚ã‚ã‚ŠãŒãŸã•ã‚’æ„Ÿã˜ã¦è¬æ„ã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚",
    "æ°—ãŒã¨ãŒã‚ã¦ã„ã‚‹": "è‡ªåˆ†ã®æ°—æŒã¡ã«ã‚„ã¾ã—ã•ã‚’æ„Ÿã˜ã¦ã„ã‚‹ã€‚",
    "æ°—è½ã¡ã—ã¦ã„ã‚‹": "ãŒã£ã‹ã‚Šã—ã¦ã€åŠ›ã‚’è½ã¨ã™ã“ã¨ã€‚æ°—ã®å¼µã‚ŠãŒã†ã›ã‚‹ã“ã¨ã€‚",
    "æ°—ã®ã‚ã‚‹ãã¶ã‚Šã‚’ã—ã¦ã„ã‚‹": "é–¢å¿ƒãŒã‚ã‚‹ãµã‚Šã‚’ã™ã‚‹ã€‚",
    "ãã¾ã‚ŠãŒæ‚ªã„": "ä»–ã«å¯¾ã—ã¦é¢ç›®ãŒç«‹ãŸãªã„ã€‚æ¥ãšã‹ã—ã„ã€‚ã—ã¾ã‚ŠãŒã¤ã‹ãªã„ã€‚",
    "èˆˆå‘³ã‚’æŒã£ã¦ã„ã‚‹": "ç‰©äº‹ã«å¿ƒãŒã²ã‹ã‚ŒãŠã‚‚ã—ã‚ã„ã¨æ„Ÿã˜ã‚‹ã“ã¨ã€‚",
    "ãã‚‡ã£ã¨ã—ã¦ã„ã‚‹": "é©šãã®ã‚ã¾ã‚Šå¿ƒãŒæ€¥ã«å‹•æºã™ã‚‹ã•ã¾ã€‚ã¯ã£ã¨ã€‚ã³ãã£ã¨ã€‚",
    "ç©ºæƒ³ã«ãµã‘ã£ã¦ã„ã‚‹": "ç¾å®Ÿã«ã¯ã‚ã‚Šãã†ã«ã‚‚ãªã„ã“ã¨ã‚’ã‚ã‚Œã“ã‚Œé ­ã®ä¸­ã§æƒ³åƒã™ã‚‹ã“ã¨ã€‚",
    "æ‚”ã‚„ã‚“ã§ã„ã‚‹": "å¤±æ•—ã—ãŸã‚Šã€ã†ã¾ãã‚†ã‹ãªã‹ã£ãŸã‚Šã—ãŸã“ã¨ã«ã¤ã„ã¦ã€åˆ¥ã®å‡¦ç†ã‚’ã—ã¦ãŠã‘ã°ã‚ˆã‹ã£ãŸã€ã¨ã‚ã¨ã«ãªã£ã¦æ®‹å¿µã«æ€ã†ã€‚ãã‚„ã—ãæ€ã†ã€‚å¾Œæ‚”ã™ã‚‹ã€‚",
    "è­¦æˆ’ã—ã¦ã„ã‚‹": "å¥½ã¾ã—ããªã„ã“ã¨ã‚„å±é™ºãªã“ã¨ãŒèµ·ã“ã‚Šãã†ãªéš›ã«ã€æœªç„¶ã«é˜²ãã‚ˆã†ã«ç”¨å¿ƒã™ã‚‹ã“ã¨ã€‚",
    "æ±ºæ„ã‚’å›ºã‚ã¦ã„ã‚‹": "é‡å¤§ãªã“ã¨ã«ã¤ã„ã¦ã€ã¨ã‚‹ã¹ãè¡Œå‹•ã‚„æ…‹åº¦ã‚’ã¯ã£ãã‚Šãã‚ã‚‹ã“ã¨ã€‚ã¾ãŸã€ãã®ãã‚ãŸæ°—æŒã¡ã€‚",
    "æ±ºå¿ƒãŒã¤ã‹ãªã„ã§ã„ã‚‹": "ã‚ã‚‹ç‰©äº‹ã‚’ã—ã‚ˆã†ã¨å¿ƒãŒãã¾ã‚‰ãªã„ã“ã¨ã€‚æ±ºæ„ãŒã¤ã‹ãªã„ã€‚",
    "å…ƒæ°—ã‚’ãªãã—ã¦ã„ã‚‹": "æ´»å‹•ã®ã‚‚ã¨ã«ãªã‚‹æ°—åŠ›ãŒãªã„ã€‚",
    "å¥½å¥‡å¿ƒã‚’æŠ±ã„ã¦ã„ã‚‹": "çã—ã„ç‰©äº‹ãƒ»æœªçŸ¥ã®äº‹æŸ„ã«å¯¾ã—ã¦èˆˆå‘³ã‚„é–¢å¿ƒã‚’æŠ±ãã€‚",
    "èˆˆå¥®ã—ã¦ã„ã‚‹": "ç‰©äº‹ã«æ„Ÿã˜ã¦æ°—æŒã¡ãŒé«˜ã¶ã‚‹ã“ã¨ã€‚",
    "å›°ã£ã¦ã„ã‚‹": "ã‚ã‚‹å¥½ã¾ã—ããªã„äº‹æ…‹ãŒç™ºç”Ÿã—ã€ãã®ã†ã¾ã„å¯¾å‡¦ã®æ–¹æ³•ãŒè¦‹ã¤ã‹ã‚‰ãšã«æ‚©ã‚€ã€‚",
    "æ€–ãŒã£ã¦ã„ã‚‹": "ã‚ã‚‹ç‰©ã‚„äº‹ã‚’ã²ã©ããŠãã‚Œã‚‹ã€‚ãŠã³ãˆã‚‹ã€‚",
    "æ··ä¹±ã—ã¦ã„ã‚‹": "ä½•ãŒãªã‚“ã ã‹åˆ†ã‹ã‚‰ãªãã®ã“ã¨ã€‚",
    "å›°æƒ‘ã—ã¦ã„ã‚‹": "ã©ã†ã—ã¦ã‚ˆã„ã‹ã‚ã‹ã‚‰ãªãã¦ã¨ã¾ã©ã†ã“ã¨ã€‚",
    "è‡ªä¿¡ã«æº€ã¡ã¦ã„ã‚‹": "è‡ªåˆ†ã®æ‰èƒ½ãƒ»ä¾¡å€¤ã‚’ãšã‚‹ã“ã¨ã€‚è‡ªåˆ†è‡ªèº«ã‚’ãšã‚‹ã“ã¨ã€‚",
    "è¦ªã—ã’ãªæ°—æŒã¡ã‚’æŠ±ã„ã¦ã„ã‚‹": "å¿ƒãŒé€šã˜ã¦ã„ã‚‹ã€ä»²ãŒã‚ˆã„ã€è¦ªå¯†ã§ã‚ã‚‹ã¨æ€ã†ã“ã¨ã€‚",
    "å«‰å¦¬ã—ã¦ã„ã‚‹": "äººã®æ„›æƒ…ãŒä»–ã«å‘ã‘ã‚‰ã‚Œã‚‹ã®ã‚’æ†ã‚€ã“ã¨ã€‚ã¾ãŸã€ãã®æ°—æŒã¡ã€‚ç‰¹ã«ã€ç”·å¥³é–“ã®æ„Ÿæƒ…ã«ã¤ã„ã¦ã„ã†ã€‚ã‚„ãã‚‚ã¡ã€‚ã™ãã‚ŒãŸè€…ã«å¯¾ã—ã¦æŠ±ãã­ãŸã¿ã®æ°—æŒã¡ã€‚ã­ãŸã¿ã€‚",
    "è‡ªåˆ†ãŒå„ªä½ã«ç«‹ã¨ã†ã¨ã—ã¦ã„ã‚‹": "ä»–ã®è€…ã‚ˆã‚Šã‚‚ã¾ã•ã‚‹ä½ç½®ãƒ»åœ°ä½ã«ç«‹ã¨ã†ã¨ã—ã¦ã„ã‚‹ã•ã¾ã€‚",
    "ã˜ã‚Šã˜ã‚Šã—ã¦ã„ã‚‹": "å¾…ã¡åˆ‡ã‚Œãªãã¦ã€ã—ã ã„ã«ã„ã‚‰ã ã¤ã•ã¾ã€‚ã¾ãŸã€ãã†ã™ã‚‹ã“ã¨ã€‚",
    "ç†Ÿæ…®ã—ã¦ã„ã‚‹": "ååˆ†ã«è€ƒãˆã‚‹ã“ã¨ã€‚ã˜ã£ãã‚Šè€ƒãˆã‚‹ã“ã¨ã€‚",
    "ç¥çµŒè³ªã«ãªã£ã¦ã„ã‚‹": "åˆºæ¿€ã‚„å¤‰åŒ–ã«å¯¾ã—ç¥çµŒãŒéæ•ã§ã‚ã‚‹æ€§è³ªã€‚äº›ç´°ï¼ˆã•ã•ã„ï¼‰ãªã“ã¨ã¾ã§æ°—ã«ã‹ã‘ã‚‹ã•ã¾ã€‚",
    "çœŸå‰£ã«ãªã£ã¦ã„ã‚‹": "ä¸€ç”Ÿæ‡¸å‘½ã«ç‰©äº‹ã‚’ã™ã‚‹ã•ã¾ã€‚æœ¬æ°—ã§ã‚ã‚‹ã•ã¾ã€‚",
    "ä¿¡ã˜ã‚‰ã‚Œãªã„ã¨æ€ã£ã¦ã„ã‚‹": "ç–‘ã£ã¦ã†ãã ã¨æ€ã„è¾¼ã‚€ã“ã¨ã€‚",
    "å¿ƒé…ã—ã¦ã„ã‚‹": "ä½•ã‹èµ·ãã¯ã—ãªã„ã‹ã¨ã€æ°—ã«ã‹ã‘ã‚‹ã“ã¨ã€‚ä¸å®‰ãŒã‚‹ã“ã¨ã€‚æ°—ãŒã‹ã‚Šã€‚",
    "å¿ƒé…ãã†ã«ã—ã¦ã„ã‚‹": "ä½•ã‹èµ·ãã¯ã—ãªã„ã‹ã¨ã€æ°—ã«ã‹ã‘ã‚‹ã“ã¨ã€‚ä¸å®‰ãŒã‚‹ã“ã¨ã€‚æ°—ãŒã‹ã‚Šã€‚",
    "ä¿¡é ¼ã§ããªã„ã¨æ€ã£ã¦ã„ã‚‹": "ä¿¡ã˜ã¦é ¼ã‚‹ã“ã¨ãŒã§ããªã„ã¨æ€ã†ã“ã¨ã€‚",
    "ã™ã¾ãªãŒã£ã¦ã„ã‚‹": "ç›¸æ‰‹ã«æ‚ªã„ã¨æ€ã£ã¦ã„ã‚‹ã€‚ç”³ã—ã‚ã‘ãªã„ã¨æ€ã£ã¦ã„ã‚‹ã€‚",
    "ãŸã‚ã‚‰ã£ã¦ã„ã‚‹": "ã—ã‚ˆã†ã‹ã—ã¾ã„ã‹ã¨è¿·ã†ã€‚æ€ã„åˆ‡ã‚ŠãŒã¤ã‹ãªãã¦è¡Œå‹•ã«ç§»ã‚Œãªã„ã€‚èºŠèº‡ï¼ˆã¡ã‚…ã†ã¡ã‚‡ï¼‰ã™ã‚‹ã€‚",
    "æ•µæ„ã‚’æŠ±ã„ã¦ã„ã‚‹": "å®³ã‚’åŠ ãˆã‚ˆã†ã¨ã™ã‚‹å¿ƒã‚’æŒã£ã¦ã„ã‚‹ã€‚æ•µå¯¾ã™ã‚‹å¿ƒã‚’æŒã¤ã€‚",
    "åŒæƒ…ã—ã¦ã„ã‚‹": "ä»–äººã®è‹¦ã—ã¿ãƒ»æ‚²ã—ã¿ãƒ»ä¸å¹¸ãªã©ã‚’åŒã˜ã‚ˆã†ã«æ„Ÿã˜ã€æ€ã„ã‚„ã‚Šãƒ»ã„ãŸã‚ã‚Šã®å¿ƒã‚’ã‚‚ã¤ã“ã¨ã€‚ã‹ã‚ã„ãã†ã«æ€ã†ã“ã¨ã€‚",
    "å½“æƒ‘ã—ã¦ã„ã‚‹": "äº‹ã®è§£æ±ºã«å›°ã‚Šé€”æ–¹ã«æš®ã‚Œã‚‹ã“ã¨ã€‚ã©ã†ã—ã¦ã‚ˆã„ã‹åˆ†ã‹ã‚‰ãªãã¦ã€æˆ¸æƒ‘ã†ã“ã¨ã€‚",
    "ã¨ã¾ã©ã£ã¦ã„ã‚‹": "äºˆæƒ³å¤–ã®äº‹ã«ã€ã©ã†å¯¾å‡¦ã—ã¦ã„ã„ã‹ã‚ã‹ã‚‰ãšã«ã¾ã”ã¤ãã€‚",
    "å†…é¢ã‚’è¦‹ã¤ã‚ã¦ã„ã‚‹": "ç²¾ç¥ãƒ»å¿ƒç†ã«é–¢ã™ã‚‹æ–¹é¢ã‚„ã€ç‰©äº‹ã®å†…å´ã€‚å¤–å´ã‹ã‚‰ã¯è¦‹ãˆãªã„éƒ¨åˆ†ã‚’è€ƒãˆã¦ã„ã‚‹ã€‚",
    "ä½•ã‹ã‚’ç¢ºä¿¡ã—ã¦ã„ã‚‹": "ã‹ãŸãä¿¡ã˜ã¦ç–‘ã‚ãªã„ã“ã¨ã€‚ã¾ãŸã€ãã®ä¿¡å¿µã‚’æŒã£ã¦ã„ã‚‹ã€‚",
    "ä½•ã‹ã‚’æœŸå¾…ã—ã¦ã„ã‚‹": "ã‚ˆã„çµæœã‚„çŠ¶æ…‹ã‚’äºˆæœŸã—ã¦ã€ãã®å®Ÿç¾ã‚’å¾…ã¡æœ›ã‚€ã“ã¨ã€‚",
    "ä½•ã‹ã‚’å¼·ãè¨´ãˆã¦ã„ã‚‹": "ç›¸æ‰‹ã®å¿ƒã‚„æ„Ÿè¦šã«å¼·ãåƒãã‹ã‘ã¦ã„ã‚‹ã€‚",
    "æ…°ã‚ã‚ˆã†ã¨ã—ã¦ã„ã‚‹": "æ‚²ã—ã‚“ã ã‚Šè‹¦ã—ã‚“ã ã‚Šã—ã¦ã„ã‚‹äººã«ã€ã‚„ã•ã—ã„è¨€è‘‰ã‚’ã‹ã‘ãŸã‚Šã—ã¦å¿ƒã‚’ãªã”ã‚„ã‹ã«ã•ã›ã€é™ã¾ã‚‰ã›ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã€‚",
    "åŠ±ã¾ãã†ã¨ã—ã¦ã„ã‚‹": "å…ƒæ°—ã‚„å‹‡æ°—ã‚’å‡ºã™ã‚ˆã†ã«ã¥ã‘ã‚ˆã†ã¨ã™ã‚‹ã€‚",
    "æ¥ãšã‹ã—ãŒã£ã¦ã„ã‚‹": "ã©ã†æŒ¯ã‚‹èˆã£ã¦ã‚ˆã„ã‹ã‚ã‹ã‚‰ãªã„æ°—æŒã¡ã ã€‚ç…§ã‚Œãã•ã„ã€‚",
    "æ¥ã˜ã¦ã„ã‚‹": "è‰¯å¿ƒãŒã¨ãŒã‚ãŸã‚Šã€æ¬ ç‚¹ãƒ»èª¤ã‚Šã«æ°—ã¥ã„ã¦ã€ä»–äººã«é¡”å‘ã‘ã§ããªã„ã¨æ€ã†ã€‚ã¯ãšã‹ã—ã„ã¨æ€ã†ã€‚",
    "éé›£ã—ã¦ã„ã‚‹": "ç›¸æ‰‹ã®æ¬ ç‚¹ã‚„éå¤±ã‚’å–ã‚Šä¸Šã’ã¦è²¬ã‚ã‚‹ã“ã¨ã€‚",
    "çš®è‚‰ãªæ°—åˆ†ã§ã‚ã‚‹": "ç›¸æ‰‹ã®æ¬ ç‚¹ã‚„å¼±ç‚¹ã‚’æ„åœ°æ‚ªãé ã¾ã‚ã—ã«éé›£ã—ãŸã„æ°—åˆ†ã€‚",
    "çš®è‚‰ã‚’è¨€ã£ã¦ã„ã‚‹": "ç›¸æ‰‹ã®æ¬ ç‚¹ã‚„å¼±ç‚¹ã‚’æ„åœ°æ‚ªãé ã¾ã‚ã—ã«éé›£ã—ã¦ã„ã‚‹ã€‚",
    "é–‹ãç›´ã£ã¦ã„ã‚‹": "æ€¥ã«æ…‹åº¦ã‚’å¤‰ãˆã¦ãã³ã—ããªã‚‹ã€‚è¦šæ‚Ÿã‚’ãã‚ã¦ã€ãµã¦ã¶ã¦ã—ã„æ…‹åº¦ã«å¤‰ã‚ã‚‹ã€‚ã„ãªãŠã‚‹ã€‚",
    "ä¸å®‰ã«æ€ã£ã¦ã„ã‚‹": "æ°—ãŒã‹ã‚Šãªã“ã¨ã€‚å¿ƒé…ãªã“ã¨ã€‚ã“ã‚Œã‹ã‚‰èµ·ã“ã‚‹äº‹æ…‹ã«å¯¾ã™ã‚‹æã‚Œã‹ã‚‰ã€æ°—æŒã¡ãŒè½ã¡ç€ã‹ãªã„ã“ã¨ã€‚",
    "ãµã–ã‘ã¦ã„ã‚‹": "å†—è«‡ã‚’è¨€ã£ãŸã‚Šã€ãŠã©ã‘ãŸã“ã¨ã‚’ã—ãŸã‚Šã™ã‚‹ã€‚",
    "ä¸æ„‰å¿«ã«æ€ã£ã¦ã„ã‚‹": "æ¥½ã—ããªã„ã“ã¨ã€‚æ°—ã«å…¥ã‚‰ãªã„ã“ã¨ã€‚ã¾ãŸã€ãã®ã•ã¾ã€‚",
    "ã»ã‹ã®ã“ã¨ã«æ°—ã‚’å–ã‚‰ã‚Œã¦ã„ã‚‹": "ã»ã‹ã®ã“ã¨ã«æ³¨æ„ã‚’ã†ã°ã‚ã‚Œã‚‹ã€‚",
    "ã»ã£ã¨ã—ã¦ã„ã‚‹": "å®‰å¿ƒã—ã¦ç·Šå¼µã®ã¨ã‘ã‚‹ã•ã¾ã€‚",
    "æº€è¶³ã—ã¦ã„ã‚‹": "æœ›ã¿ãŒé”ã›ã‚‰ã‚Œã¦ä¸å¹³ã®ãªã„ã“ã¨ã€‚ååˆ†æº€ã¡è¶³ã‚Šã¦ã„ã‚‹ã“ã¨ã€‚",
    "ç„¡é–¢å¿ƒã§ã‚ã‚‹": "æ°—ã«ã‹ã‘ãªã„ã“ã¨ã€‚èˆˆå‘³ã‚’ç¤ºã•ãªã„ã“ã¨ã€‚",
    "ç”³ã—è¨³ãªã„ã¨æ€ã£ã¦ã„ã‚‹": "ç›¸æ‰‹ã«ã™ã¾ãªã„æ°—æŒã¡ã§ã€å¼è§£ã®ã—ã‚ˆã†ãŒãªã„ã¨æ€ã£ã¦ã„ã‚‹ã€‚ãŸã„ã¸ã‚“ã™ã¾ãªã„ã¨æ€ã£ã¦ã„ã‚‹ã€‚",
    "é»™æƒ³ã—ã¦ã„ã‚‹": "é»™ã£ã¦æ€ã„ã«ãµã‘ã‚‹ã“ã¨ã€‚",
    "ç‰©æ€ã„ã«ãµã‘ã£ã¦ã„ã‚‹": "ã‚ã‚Œã“ã‚Œã¨æ€ã„æ‚©ã‚€ã“ã¨ã€‚æ†‚ãˆæ€ã†ã“ã¨ã€‚",
    "ç”¨å¿ƒã—ã¦ã„ã‚‹": "ä¸‡ä¸€ã«å‚™ãˆã¦è­¦æˆ’ãƒ»æ³¨æ„ã™ã‚‹ã“ã¨ã€‚æ°—ã‚’ã¤ã‘ã‚‹ã“ã¨ã€‚",
    "æ¬²æœ›ã‚’æŠ±ã„ã¦ã„ã‚‹": "ã»ã—ã„ã¨æ€ã†å¿ƒã‚’æŒã£ã¦ã„ã‚‹ã€‚ä¸è¶³ã‚’æº€ãŸãã†ã¨å¼·ãæ±‚ã‚ã‚‹æ°—æŒã¡ã‚’æŒã¤ã€‚",
    "ç‹¼ç‹½ã—ã¦ã„ã‚‹": "äºˆæƒ³å¤–ã®äº‹æ…‹ã«ã©ã†ã—ã¦ã‚ˆã„ã‹ã‚ã‹ã‚‰ãšã€ã¾ã”ã¾ã”ã™ã‚‹ã€‚",
    "ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¦ã„ã‚‹": "ç²¾ç¥ã‚„è‚‰ä½“ã®ç·Šå¼µã‚’ã»ãã™ã“ã¨ã€‚ãã¤ã‚ãã“ã¨ã€‚",
    "æ†ã—ã¿ã‚’æŒã£ã¦ã„ã‚‹": "æ¿€ã—ã„æ¨ã¿ã‚’å¿ƒã«æŒã¤ã“ã¨ã€‚å¼·ã„å«Œæ‚ªæ„Ÿã‚’æŠ±ãã€‚"
  };

  function detectSystemInfo() {
    const ua = navigator.userAgent;
    let browser = 'Unknown', os = 'Unknown';
    if (ua.indexOf('Firefox') > -1) browser = 'Firefox';
    else if (ua.indexOf('Opera') > -1 || ua.indexOf('OPR') > -1) browser = 'Opera';
    else if (ua.indexOf('Trident') > -1) browser = 'Internet Explorer';
    else if (ua.indexOf('Edge') > -1 || ua.indexOf('Edg') > -1) browser = 'Edge';
    else if (ua.indexOf('Chrome') > -1) browser = 'Chrome';
    else if (ua.indexOf('Safari') > -1) browser = 'Safari';
    if (ua.indexOf('Win') > -1) os = 'Windows';
    else if (ua.indexOf('Mac') > -1) os = 'macOS';
    else if (ua.indexOf('Linux') > -1) os = 'Linux';
    else if (ua.indexOf('Android') > -1) os = 'Android';
    else if (ua.indexOf('iOS') > -1 || ua.indexOf('iPhone') > -1 || ua.indexOf('iPad') > -1) os = 'iOS';
    return { browser, os, userAgent: ua };
  }

  function buildDefinitionsHTML(options) {
    let html = '<div class="word-definitions">';
    options.forEach((word) => {
      const definition = wordDefinitions[word] || 'èª¬æ˜æ–‡ãŒã‚ã‚Šã¾ã›ã‚“ã€‚';
      html += `
        <div class="definition-item">
          <span class="definition-word">${word}</span>
          <span class="definition-text">${definition}</span>
        </div>
      `;
    });
    html += '</div>';
    return html;
  }

  const jsPsych = window.jsPsychModule.initJsPsych({
    display_element: 'jspsych-target'
  });

  const subjectId = jsPsych.randomization.randomID(10);
  const systemInfo = detectSystemInfo();
  jsPsych.data.addProperties({
    subject_id: subjectId,
    timestamp_start: new Date().toISOString(),
    browser: systemInfo.browser,
    os: systemInfo.os,
    task_name: 'EYES_TEST',
    total_trials: 36,
    practice_trials: 1
  });

  function shuffleArray(array) {
    const shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
  }

  // æ­£ç­”ãƒªã‚¹ãƒˆ
  // ç·´ç¿’: æ··ä¹±ã—ã¦ã„ã‚‹
  // æœ¬è©¦è¡Œ1-36ã®æ­£ç­”ã¯é¸æŠè‚¢ã®æ­£ç­”ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å¯¾å¿œ
  const newCorrectList = [
    "æ··ä¹±ã—ã¦ã„ã‚‹", // ç·´ç¿’
    "ãŠã©ã‘ã¦ã„ã‚‹", // 1
    "ç‹¼ç‹½ã—ã¦ã„ã‚‹", // 2
    "æ¬²æœ›ã‚’æŠ±ã„ã¦ã„ã‚‹", // 3
    "ä½•ã‹ã‚’å¼·ãè¨´ãˆã¦ã„ã‚‹", // 4
    "å¿ƒé…ã—ã¦ã„ã‚‹", // 5
    "ç©ºæƒ³ã«ãµã‘ã£ã¦ã„ã‚‹", // 6
    "è½ã¡ç€ã‹ãªã„æ°—æŒã¡ã§ã„ã‚‹", // 7
    "æ°—è½ã¡ã—ã¦ã„ã‚‹", // 8
    "ã»ã‹ã®ã“ã¨ã«æ°—ã‚’å–ã‚‰ã‚Œã¦ã„ã‚‹", // 9
    "ç”¨å¿ƒã—ã¦ã„ã‚‹", // 10
    "æ‚”ã‚„ã‚“ã§ã„ã‚‹", // 11
    "ç–‘ã„ã‚’æŠ±ã„ã¦ã„ã‚‹", // 12
    "ä½•ã‹ã‚’æœŸå¾…ã—ã¦ã„ã‚‹", // 13
    "éé›£ã—ã¦ã„ã‚‹", // 14
    "é»™æƒ³ã—ã¦ã„ã‚‹", // 15
    "è€ƒãˆã«ãµã‘ã£ã¦ã„ã‚‹", // 16
    "ç–‘ã£ã¦ã„ã‚‹", // 17
    "æ±ºæ„ã‚’å›ºã‚ã¦ã„ã‚‹", // 18
    "ãŸã‚ã‚‰ã£ã¦ã„ã‚‹", // 19
    "è¦ªã—ã’ãªæ°—æŒã¡ã‚’æŠ±ã„ã¦ã„ã‚‹", // 20
    "ç©ºæƒ³ã«ãµã‘ã£ã¦ã„ã‚‹", // 21
    "ã»ã‹ã®ã“ã¨ã«æ°—ã‚’å–ã‚‰ã‚Œã¦ã„ã‚‹", // 22
    "é–‹ãç›´ã£ã¦ã„ã‚‹", // 23
    "ç‰©æ€ã„ã«ãµã‘ã£ã¦ã„ã‚‹", // 24
    "èˆˆå‘³ã‚’æŒã£ã¦ã„ã‚‹", // 25
    "æ•µæ„ã‚’æŠ±ã„ã¦ã„ã‚‹", // 26
    "ç”¨å¿ƒã—ã¦ã„ã‚‹", // 27
    "èˆˆå‘³ã‚’æŒã£ã¦ã„ã‚‹", // 28
    "å†…é¢ã‚’è¦‹ã¤ã‚ã¦ã„ã‚‹", // 29
    "æ°—ã®ã‚ã‚‹ãã¶ã‚Šã‚’ã—ã¦ã„ã‚‹", // 30
    "è‡ªä¿¡ã«æº€ã¡ã¦ã„ã‚‹", // 31
    "çœŸå‰£ã«ãªã£ã¦ã„ã‚‹", // 32
    "å¿ƒé…ãã†ã«ã—ã¦ã„ã‚‹", // 33
    "ä¿¡é ¼ã§ããªã„ã¨æ€ã£ã¦ã„ã‚‹", // 34
    "ç¥çµŒè³ªã«ãªã£ã¦ã„ã‚‹", // 35
    "ç–‘ã£ã¦ã„ã‚‹" // 36
  ];

  const eyeTrials = [
    { image: "eyes_pngs/eyes_01.png", correct: 1, options: ["å«‰å¦¬ã—ã¦ã„ã‚‹", "æ··ä¹±ã—ã¦ã„ã‚‹", "æ¨ªæŸ„ãªæ°—åˆ†ã§ã‚ã‚‹", "æ†ã—ã¿ã‚’æŒã£ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_02.png", correct: 0, options: ["ãŠã©ã‘ã¦ã„ã‚‹", "æ…°ã‚ã‚ˆã†ã¨ã—ã¦ã„ã‚‹", "ã„ã‚‰ã ã£ã¦ã„ã‚‹", "ã†ã‚“ã–ã‚Šã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_03.png", correct: 1, options: ["ãŠã³ãˆã¦ã„ã‚‹", "ç‹¼ç‹½ã—ã¦ã„ã‚‹", "æ¨ªæŸ„ãªæ°—åˆ†ã§ã‚ã‚‹", "ä¸æ„‰å¿«ã«æ€ã£ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_04.png", correct: 2, options: ["ãµã–ã‘ã¦ã„ã‚‹", "ã†ã‚ãŸãˆã¦ã„ã‚‹", "æ¬²æœ›ã‚’æŠ±ã„ã¦ã„ã‚‹", "ä½•ã‹ã‚’ç¢ºä¿¡ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_05.png", correct: 1, options: ["ãµã–ã‘ã¦ã„ã‚‹", "ä½•ã‹ã‚’å¼·ãè¨´ãˆã¦ã„ã‚‹", "é¢ç™½ãŒã£ã¦ã„ã‚‹", "ãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_06.png", correct: 2, options: ["ã„ã‚‰ã ã£ã¦ã„ã‚‹", "çš®è‚‰ãªæ°—åˆ†ã§ã‚ã‚‹", "å¿ƒé…ã—ã¦ã„ã‚‹", "è¦ªã—ã’ãªæ°—æŒã¡ã‚’æŠ±ã„ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_07.png", correct: 1, options: ["ãã‚‡ã£ã¨ã—ã¦ã„ã‚‹", "ç©ºæƒ³ã«ãµã‘ã£ã¦ã„ã‚‹", "ã˜ã‚Šã˜ã‚Šã—ã¦ã„ã‚‹", "è­¦æˆ’ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_08.png", correct: 2, options: ["ã™ã¾ãªãŒã£ã¦ã„ã‚‹", "è¦ªã—ã’ãªæ°—æŒã¡ã‚’æŠ±ã„ã¦ã„ã‚‹", "è½ã¡ç€ã‹ãªã„æ°—æŒã¡ã§ã„ã‚‹", "å…ƒæ°—ã‚’ãªãã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_09.png", correct: 0, options: ["æ°—è½ã¡ã—ã¦ã„ã‚‹", "ã»ã£ã¨ã—ã¦ã„ã‚‹", "æ¥ãšã‹ã—ãŒã£ã¦ã„ã‚‹", "èˆˆå¥®ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_10.png", correct: 3, options: ["ä¸æ„‰å¿«ã«æ€ã£ã¦ã„ã‚‹", "æ•µæ„ã‚’æŠ±ã„ã¦ã„ã‚‹", "æ€–ãŒã£ã¦ã„ã‚‹", "ã»ã‹ã®ã“ã¨ã«æ°—ã‚’å–ã‚‰ã‚Œã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_11.png", correct: 0, options: ["ç”¨å¿ƒã—ã¦ã„ã‚‹", "ä½•ã‹ã‚’å¼·ãè¨´ãˆã¦ã„ã‚‹", "ã†ã‚“ã–ã‚Šã—ã¦ã„ã‚‹", "ãã‚‡ã£ã¨ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_12.png", correct: 2, options: ["ãŠã³ãˆã¦ã„ã‚‹", "é¢ç™½ãŒã£ã¦ã„ã‚‹", "æ‚”ã‚„ã‚“ã§ã„ã‚‹", "æ°—ã®ã‚ã‚‹ãã¶ã‚Šã‚’ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_13.png", correct: 2, options: ["ç„¡é–¢å¿ƒã§ã‚ã‚‹", "ãã¾ã‚ŠãŒæ‚ªã„", "ç–‘ã„ã‚’æŠ±ã„ã¦ã„ã‚‹", "å…ƒæ°—ã‚’ãªãã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_14.png", correct: 1, options: ["æ±ºæ„ã‚’å›ºã‚ã¦ã„ã‚‹", "ä½•ã‹ã‚’æœŸå¾…ã—ã¦ã„ã‚‹", "è„…ã—ã¦ã„ã‚‹", "æ¥ãšã‹ã—ãŒã£ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_15.png", correct: 3, options: ["ã„ã‚‰ã ã£ã¦ã„ã‚‹", "ãŒã£ã‹ã‚Šã—ã¦ã„ã‚‹", "è½ã¡è¾¼ã‚“ã§ã„ã‚‹", "éé›£ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_16.png", correct: 0, options: ["é»™æƒ³ã—ã¦ã„ã‚‹", "ã†ã‚ãŸãˆã¦ã„ã‚‹", "åŠ±ã¾ãã†ã¨ã—ã¦ã„ã‚‹", "é¢ç™½ãŒã£ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_17.png", correct: 1, options: ["ã„ã‚‰ã ã£ã¦ã„ã‚‹", "è€ƒãˆã«ãµã‘ã£ã¦ã„ã‚‹", "åŠ±ã¾ãã†ã¨ã—ã¦ã„ã‚‹", "åŒæƒ…ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_18.png", correct: 0, options: ["ç–‘ã£ã¦ã„ã‚‹", "æ„›æƒ…ã‚’æŒã£ã¦ã„ã‚‹", "ãŠã©ã‘ã¦ã„ã‚‹", "ãã‚‡ã£ã¨ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_19.png", correct: 0, options: ["æ±ºæ„ã‚’å›ºã‚ã¦ã„ã‚‹", "é¢ç™½ãŒã£ã¦ã„ã‚‹", "ãã‚‡ã£ã¨ã—ã¦ã„ã‚‹", "ã†ã‚“ã–ã‚Šã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_20.png", correct: 3, options: ["æ¨ªæŸ„ãªæ°—åˆ†ã§ã‚ã‚‹", "æ„Ÿè¬ã—ã¦ã„ã‚‹", "çš®è‚‰ã‚’è¨€ã£ã¦ã„ã‚‹", "ãŸã‚ã‚‰ã£ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_21.png", correct: 1, options: ["è‡ªåˆ†ãŒå„ªä½ã«ç«‹ã¨ã†ã¨ã—ã¦ã„ã‚‹", "è¦ªã—ã’ãªæ°—æŒã¡ã‚’æŠ±ã„ã¦ã„ã‚‹", "æ°—ãŒã¨ãŒã‚ã¦ã„ã‚‹", "æ€–ãŒã£ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_22.png", correct: 1, options: ["ãã¾ã‚ŠãŒæ‚ªã„", "ç©ºæƒ³ã«ãµã‘ã£ã¦ã„ã‚‹", "å›°æƒ‘ã—ã¦ã„ã‚‹", "æ··ä¹±ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_23.png", correct: 0, options: ["ã»ã‹ã®ã“ã¨ã«æ°—ã‚’å–ã‚‰ã‚Œã¦ã„ã‚‹", "æ„Ÿè¬ã—ã¦ã„ã‚‹", "ä½•ã‹ã‚’å¼·ãè¨´ãˆã¦ã„ã‚‹", "å“€é¡˜ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_24.png", correct: 2, options: ["æº€è¶³ã—ã¦ã„ã‚‹", "ç”³ã—è¨³ãªã„ã¨æ€ã£ã¦ã„ã‚‹", "é–‹ãç›´ã£ã¦ã„ã‚‹", "å¥½å¥‡å¿ƒã‚’æŠ±ã„ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_25.png", correct: 0, options: ["ç‰©æ€ã„ã«ãµã‘ã£ã¦ã„ã‚‹", "ã„ã‚‰ã ã£ã¦ã„ã‚‹", "èˆˆå¥®ã—ã¦ã„ã‚‹", "æ•µæ„ã‚’æŠ±ã„ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_26.png", correct: 3, options: ["æ··ä¹±ã—ã¦ã„ã‚‹", "ä¿¡ã˜ã‚‰ã‚Œãªã„ã¨æ€ã£ã¦ã„ã‚‹", "æ°—è½ã¡ã—ã¦ã„ã‚‹", "èˆˆå‘³ã‚’æŒã£ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_27.png", correct: 0, options: ["è­¦æˆ’ã—ã¦ã„ã‚‹", "æ¥ãšã‹ã—ãŒã£ã¦ã„ã‚‹", "æ•µæ„ã‚’æŠ±ã„ã¦ã„ã‚‹", "ä¸å®‰ã«æ€ã£ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_28.png", correct: 1, options: ["ãµã–ã‘ã¦ã„ã‚‹", "ç”¨å¿ƒã—ã¦ã„ã‚‹", "æ¨ªæŸ„ãªæ°—åˆ†ã§ã‚ã‚‹", "å®‰å¿ƒã•ã›ã‚ˆã†ã¨ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_29.png", correct: 0, options: ["èˆˆå‘³ã‚’æŒã£ã¦ã„ã‚‹", "ãµã–ã‘ã¦ã„ã‚‹", "æ„›æƒ…ã‚’æŒã£ã¦ã„ã‚‹", "æº€è¶³ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_30.png", correct: 3, options: ["ã˜ã‚Šã˜ã‚Šã—ã¦ã„ã‚‹", "ãã‚‡ã£ã¨ã—ã¦ã„ã‚‹", "ã„ã‚‰ã ã£ã¦ã„ã‚‹", "å†…é¢ã‚’è¦‹ã¤ã‚ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_31.png", correct: 1, options: ["æ„Ÿè¬ã—ã¦ã„ã‚‹", "æ°—ã®ã‚ã‚‹ãã¶ã‚Šã‚’ã—ã¦ã„ã‚‹", "æ•µæ„ã‚’æŠ±ã„ã¦ã„ã‚‹", "ãŒã£ã‹ã‚Šã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_32.png", correct: 1, options: ["æ¥ã˜ã¦ã„ã‚‹", "è‡ªä¿¡ã«æº€ã¡ã¦ã„ã‚‹", "ãµã–ã‘ã¦ã„ã‚‹", "å…ƒæ°—ã‚’ãªãã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_33.png", correct: 0, options: ["çœŸå‰£ã«ãªã£ã¦ã„ã‚‹", "æ¥ã˜ã¦ã„ã‚‹", "å½“æƒ‘ã—ã¦ã„ã‚‹", "è­¦æˆ’ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_34.png", correct: 3, options: ["ãã¾ã‚ŠãŒæ‚ªã„", "æ°—ãŒã¨ãŒã‚ã¦ã„ã‚‹", "ç©ºæƒ³ã«ãµã‘ã£ã¦ã„ã‚‹", "å¿ƒé…ãã†ã«ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_35.png", correct: 2, options: ["ãã‚‡ã£ã¨ã—ã¦ã„ã‚‹", "ã¨ã¾ã©ã£ã¦ã„ã‚‹", "ä¿¡é ¼ã§ããªã„ã¨æ€ã£ã¦ã„ã‚‹", "ãŠã³ãˆã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_36.png", correct: 1, options: ["å›°ã£ã¦ã„ã‚‹", "ç¥çµŒè³ªã«ãªã£ã¦ã„ã‚‹", "ä½•ã‹ã‚’å¼·ãè¨´ãˆã¦ã„ã‚‹", "ç†Ÿæ…®ã—ã¦ã„ã‚‹"] },
    { image: "eyes_pngs/eyes_37.png", correct: 2, options: ["æ¥ã˜ã¦ã„ã‚‹", "ç¥çµŒè³ªã«ãªã£ã¦ã„ã‚‹", "ç–‘ã£ã¦ã„ã‚‹", "æ±ºå¿ƒãŒã¤ã‹ãªã„ã§ã„ã‚‹"] },
  ];
  // å„æ­£ç­”ãŒé¸æŠè‚¢ã«å«ã¾ã‚Œã¦ã„ãªã„å ´åˆã¯è­¦å‘Šã‚³ãƒ¡ãƒ³ãƒˆã‚’å‡ºåŠ›
  eyeTrials.forEach((trial, idx) => {
    const correctWord = newCorrectList[idx];
    if (!trial.options.includes(correctWord)) {
      // eslint-disable-next-line no-console
      console.warn(`è­¦å‘Š: å•é¡Œ${idx+1}ã®æ­£ç­”ã€Œ${correctWord}ã€ã¯é¸æŠè‚¢ã«å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“`);
    }
  });

  const timeline = [];
  
  // ç·´ç¿’è©¦è¡Œï¼ˆeyes_01.pngï¼‰ã¨æœ¬è©¦è¡Œï¼ˆeyes_02.pngã€œeyes_37.pngï¼‰ã‚’åˆ†é›¢
  const practiceTrial = eyeTrials[0]; // eyes_01.png
  const mainTrials = eyeTrials.slice(1); // eyes_02.pngã€œeyes_37.png
  const shuffledMainTrials = shuffleArray(mainTrials);
  let responses = [];

  timeline.push({
    type: window.jsPsychHtmlButtonResponse,
    stimulus: '<div class="card"><h1>ğŸ‘ï¸ EYES TEST</h1><h2>å¿ƒã®èª­ã¿å–ã‚Šæ¤œæŸ»<br>ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³</h2><p style="text-align: center; color: #666; margin: 1rem 0;">ã“ã‚Œã‹ã‚‰äººã®ç›®ã®éƒ¨åˆ†ã®ã¿ãŒå†™ã£ãŸå†™çœŸã‚’ç¤ºã—ã¾ã™ã€‚å†™çœŸã®äººç‰©ãŒè€ƒãˆã¦ã„ã‚‹ã“ã¨ã‚„æ„Ÿã˜ã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã‚‹ã“ã¨ã‚’ã‚‚ã£ã¨ã‚‚ã‚ˆãè¡¨ã™è¨€è‘‰ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚ä¸€ã¤ä»¥ä¸Šã®è¨€è‘‰ãŒå½“ã¦ã¯ã¾ã‚‹ã¨æ€ã†å ´åˆãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã‚‚ã£ã¨ã‚‚é©åˆ‡ã ã¨æ€ã†è¨€è‘‰ã‚’ä¸€ã¤ã ã‘é¸ã‚“ã§ãã ã•ã„ã€‚é¸ã¶å‰ã«ã¯ã€å¿…ãš4ã¤ã®è¨€è‘‰ã™ã¹ã¦ã«ç›®ã‚’é€šã—ã¦ãã ã•ã„ã€‚ãƒ†ã‚¹ãƒˆã«ã‹ã‹ã£ãŸæ™‚é–“ã¯è¨ˆã‚Šã¾ã›ã‚“ãŒã€ã§ãã‚‹ã ã‘æ—©ãç­”ãˆã‚’å‡ºã™ã‚ˆã†ã«è©¦ã¿ã¦ãã ã•ã„ã€‚è¨€è‘‰ã®æ„å‘³ãŒã‚ã‹ã‚‰ãªã„å ´åˆã¯ã€èªã®æ„å‘³ã®èª¬æ˜ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚</p></div>',
    choices: ['é–‹å§‹ã™ã‚‹']
  });

  // å¹´é½¢ãƒ»æ€§åˆ¥å…¥åŠ›
  timeline.push({
    type: window.jsPsychHtmlButtonResponse,
    stimulus: `
      <div class="card" style="max-width: 600px;">
        <h2 style="text-align: center;">å‚åŠ è€…æƒ…å ±ã®å…¥åŠ›</h2>
        <div style="margin: 2rem 0;">
          <div style="margin: 1rem 0;">
            <label for="age_input" style="display: block; margin-bottom: 0.5rem;">å¹´é½¢: <span style="color: red;">*</span></label>
            <input type="number" id="age_input" min="1" max="150" style="width: 100%; padding: 0.5rem; font-size: 1rem; border: 1px solid #ccc; border-radius: 4px;" />
          </div>
          <div style="margin: 1rem 0;">
            <label for="gender_input" style="display: block; margin-bottom: 0.5rem;">æ€§åˆ¥: <span style="color: red;">*</span></label>
            <select id="gender_input" style="width: 100%; padding: 0.5rem; font-size: 1rem; border: 1px solid #ccc; border-radius: 4px;">
              <option value="">-- é¸æŠ --</option>
              <option value="ç”·æ€§">ç”·æ€§</option>
              <option value="å¥³æ€§">å¥³æ€§</option>
              <option value="ãã®ä»–">ãã®ä»–</option>
              <option value="æœªå›ç­”">æœªå›ç­”</option>
            </select>
          </div>
          <div id="error_message" style="color: red; margin-top: 1rem; text-align: center; display: none; font-weight: bold;">
            å¹´é½¢ã¨æ€§åˆ¥ã¯å¿…é ˆã§ã™ã€‚
          </div>
        </div>
      </div>
    `,
    choices: ['æ¬¡ã¸é€²ã‚€'],
    on_load: () => {
      const button = document.querySelector('.jspsych-btn');
      button.addEventListener('click', (e) => {
        const age = document.getElementById('age_input')?.value;
        const gender = document.getElementById('gender_input')?.value;
        
        if (!age || !gender || age === '' || gender === '') {
          e.preventDefault();
          e.stopPropagation();
          document.getElementById('error_message').style.display = 'block';
          return false;
        }
        
        // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é€šéå¾Œã€ãƒ‡ãƒ¼ã‚¿ã‚’å³åº§ã«è¨˜éŒ²
        jsPsych.data.addProperties({
          age: age,
          gender: gender
        });
      });
    },
    on_finish: (data) => {
      const age = document.getElementById('age_input')?.value || '';
      const gender = document.getElementById('gender_input')?.value || '';
      data.age = age;
      data.gender = gender;
    }
  });

  // =====================================
  // ç·´ç¿’è©¦è¡Œï¼ˆeyes_01.pngï¼‰
  // =====================================
  timeline.push({
    type: window.jsPsychHtmlButtonResponse,
    stimulus: '<div class="card"><h2 style="text-align: center; color: #0071e3;">ç·´ç¿’è©¦è¡Œ</h2><p style="text-align: center; color: #666;">ã¾ãšç·´ç¿’ã¨ã—ã¦1å•è§£ã„ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p></div>',
    choices: ['ç·´ç¿’ã‚’é–‹å§‹ã™ã‚‹']
  });

  timeline.push({
    type: window.jsPsychHtmlButtonResponse,
    stimulus: `<div class="card"><h2>ç·´ç¿’å•é¡Œ</h2><p style="text-align: center; color: #666;">ã“ã®äººç‰©ã¯ä½•ã‚’è€ƒãˆãŸã‚Šã€æ„Ÿã˜ãŸã‚Šã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</p><div style="text-align: center;"><img src="${practiceTrial.image}" style="max-width: 400px; height: auto; border-radius: 8px;" alt="eyes" /></div></div>`,
    choices: practiceTrial.options,
    button_html: '<button class="jspsych-btn">%choice%</button>',
    on_finish: (data) => {
      const chosenLabel = practiceTrial.options[data.response];
      const correctLabel = practiceTrial.options[practiceTrial.correct];
      const isCorrect = data.response === practiceTrial.correct;
      data.chosen_label = chosenLabel;
      data.correct_label = correctLabel;
      data.is_correct = isCorrect;
      data.trial_type_custom = 'practice';
    },
    on_load: () => {
      setTimeout(() => {
        const jspsychContent = document.querySelector('.jspsych-content');
        if (jspsychContent) {
          const definitionsDiv = document.createElement('div');
          definitionsDiv.innerHTML = buildDefinitionsHTML(practiceTrial.options);
          jspsychContent.appendChild(definitionsDiv);
        }
      }, 0);
    }
  });

  // ç·´ç¿’è©¦è¡Œã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
  timeline.push({
    type: window.jsPsychHtmlButtonResponse,
    stimulus: function() {
      const lastTrial = jsPsych.data.get().last(1).values()[0];
      const isCorrect = lastTrial.is_correct;
      const feedbackMsg = isCorrect 
        ? '<p style="color: #34c759; font-size: 1.2rem; font-weight: bold;">âœ“ æ­£è§£ã§ã™ï¼</p>' 
        : '<p style="color: #ff3b30; font-size: 1.2rem; font-weight: bold;">âœ— ä¸æ­£è§£ã§ã—ãŸ</p>';
      return `<div class="card"><h2>ç·´ç¿’è©¦è¡Œã®çµæœ</h2>${feedbackMsg}<p style="color: #666;">æ­£ç­”ã¯ã€Œ${lastTrial.correct_label}ã€ã§ã—ãŸã€‚</p><p style="color: #666; margin-top: 1.5rem;">ãã‚Œã§ã¯æœ¬è©¦è¡Œã‚’é–‹å§‹ã—ã¾ã™ã€‚æœ¬è©¦è¡Œã§ã¯36å•ã®è³ªå•ã«ç­”ãˆã¦ã„ãŸã ãã¾ã™ã€‚</p></div>`;
    },
    choices: ['æœ¬è©¦è¡Œã‚’é–‹å§‹ã™ã‚‹']
  });

  // =====================================
  // æœ¬è©¦è¡Œï¼ˆeyes_02.pngã€œeyes_37.pngï¼‰
  // =====================================
  shuffledMainTrials.forEach((trial, index) => {
    timeline.push({
      type: window.jsPsychHtmlButtonResponse,
      stimulus: `<div class="card"><h2>å•é¡Œ ${index + 1} / 36</h2><p style="text-align: center; color: #666;">ã“ã®äººç‰©ã¯ä½•ã‚’è€ƒãˆãŸã‚Šã€æ„Ÿã˜ãŸã‚Šã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</p><div style="text-align: center;"><img src="${trial.image}" style="max-width: 400px; height: auto; border-radius: 8px;" alt="eyes" /></div></div>`,
      choices: trial.options,
      button_html: '<button class="jspsych-btn">%choice%</button>',
      on_finish: (data) => {
        const chosenLabel = trial.options[data.response];
        const correctLabel = trial.options[trial.correct];
        const isCorrect = data.response === trial.correct;
        data.chosen_label = chosenLabel;
        data.correct_label = correctLabel;
        data.is_correct = isCorrect;
        data.trial_type_custom = 'main';
        responses.push({ trial: index + 1, is_correct: isCorrect, chosen: data.response });
      },
      on_load: () => {
        setTimeout(() => {
          const jspsychContent = document.querySelector('.jspsych-content');
          if (jspsychContent) {
            const definitionsDiv = document.createElement('div');
            definitionsDiv.innerHTML = buildDefinitionsHTML(trial.options);
            jspsychContent.appendChild(definitionsDiv);
          }
        }, 0);
      }
    });
  });

  // =====================================
  // ãƒ‡ãƒ¼ã‚¿ä¿å­˜è©¦è¡Œï¼ˆDatapipeçµŒç”±ï¼‰- æœ€çµ‚çµæœè¡¨ç¤ºã®å‰ã«å®Ÿè¡Œ
  // =====================================
  timeline.push({
    type: window.jsPsychPipe,
    action: 'save',
    experiment_id: 'nSkF9Rz1SbMV',
    filename: () => {
      try {
        const allData = jsPsych.data.get().values();
        const subjectId = allData.length > 0 ? allData[0].subject_id : 'unknown_subject';
        console.log('=== Pipe trial: filename:', subjectId);
        return `${subjectId}.csv`;
      } catch (e) {
        console.error('Filename error:', e);
        return 'unknown_subject.csv';
      }
    },
    data_string: () => {
      try {
        const csvData = jsPsych.data.get().csv();
        console.log('=== Pipe trial: CSV size:', csvData.length, 'bytes');
        return csvData;
      } catch (e) {
        console.error('CSV error:', e);
        return '';
      }
    },
    on_finish: () => {
      console.log('=== Pipe trial on_finish: Data saved successfully ===');
      // å¯èƒ½ã§ã‚ã‚Œã°ç›´å‰ã®ãƒˆãƒ©ã‚¤ã‚¢ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æ‹¾ã£ã¦ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ä¿æŒï¼ˆæœªå®šç¾©ã§ã‚‚å•é¡Œãªã—ï¼‰
      try {
        const last = jsPsych.data.get().last(1).values()[0] || {};
        window.pipeStatus = {
          success: last.success ?? null,
          message: last.message ?? '',
        };
        console.log('=== Pipe status ===', window.pipeStatus);
      } catch (e) {
        console.warn('Pipe status capture failed:', e);
      } 
    }
  });

  timeline.push({
    type: window.jsPsychHtmlButtonResponse,
    stimulus: function() {
      const correctCount = responses.filter((r) => r.is_correct).length;
      const percentage = Math.round((correctCount / 36) * 100);
      return `<div class="card"><h1>ãƒ†ã‚¹ãƒˆå®Œäº†</h1><div class="result-grid"><div class="result-item"><div class="result-label">æ­£ç­”æ•°</div><div class="result-value" style="color: #34c759; font-size: 2rem;">${correctCount} / 36</div></div><div class="result-item"><div class="result-label">æ­£ç­”ç‡</div><div class="result-value" style="font-size: 2rem;">${percentage}%</div></div></div><p style="text-align: center; color: #666; margin-top: 1rem;">â€»ç·´ç¿’è©¦è¡Œã¯å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“</p></div>`;
    },
    choices: ['çµ‚äº†'],
    on_finish: (data) => {
      // çµæœç¢ºèªå¾Œã«ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸é·ç§»
      setTimeout(() => {
        window.location.href = 'https://mshrymgc.github.io/epp_scales/';
      }, 500);
    }
  });

  jsPsych.run(timeline);
})();
  </script>
</body>
</html>
