# アンケート調査デプロイメント チェックリスト

本チェックリストは、jsPsychを使用した心理学的アンケート調査を本番環境にデプロイする前に実施すべき全てのチェック項目を網羅しています。

**適用対象:** Likert尺度、選択肢、逆転項目、複数ページ構成のアンケート全般

**最終更新:** 2025年10月27日  
**参考実装:** BFI-2-S-J（日本語版 Big Five Inventory-2 短縮版）

---

## 第I章: 事前準備フェーズ

### 1.1 研究倫理・申請関連

- [ ] **倫理審査承認の取得**
  - [ ] 所属機関の倫理審査委員会（IRB/REB）から承認を得ている
  - [ ] 承認番号をドキュメント化している
  - [ ] 承認期限を確認している

- [ ] **インフォームドコンセント**
  - [ ] 同意画面のテキストが倫理審査承認版と一致している
  - [ ] 同意画面に以下の情報が含まれている：
    - [ ] 研究の目的
    - [ ] 参加者の権利（撤回、拒否など）
    - [ ] 個人情報保護方針
    - [ ] 研究者連絡先
    - [ ] 受付時間・問い合わせ方法
  - [ ] 多言語対応が必要な場合、訳文の正確性を確認している

- [ ] **個人情報保護方針**
  - [ ] プライバシーポリシーが最新である
  - [ ] データ保管期間が明記されている
  - [ ] データ保管場所が明記されている
  - [ ] GDPR・個人情報保護法等の規制要件を満たしている

### 1.2 学術上の準備

- [ ] **文献調査**
  - [ ] 使用するアンケート（BFI-2-S-Jなど）の出典論文を入手している
  - [ ] 著作権・使用ライセンスを確認している
  - [ ] 日本語版がある場合、翻訳の適切性を確認している

- [ ] **理論的背景**
  - [ ] アンケートの構成概念が明確である
  - [ ] ドメイン・ファセット構造が文献から確認できている
  - [ ] 逆転項目の理論的根拠が明確である

---

## 第II章: 技術仕様設定フェーズ

### 2.1 質問項目の定義

- [ ] **選択肢数の決定**
  - [ ] Likert尺度の選択肢数を決定している（例：5段階、7段階など）
  - [ ] 選択肢の定義が明確である（例：「1=全くあてはまらない」～「5=とてもよくあてはまる」）
  - [ ] 選択肢の文言が被験者にとって理解しやすい
  - [ ] 文化的違い（日本語他言語）に対応している

- [ ] **逆転項目の特定**
  - [ ] 逆転項目が文献から正確に特定されている
  - [ ] 逆転項目リストをドキュメント化している
  - [ ] 逆転項目の総数と各ドメイン内での分布が記録されている
  - [ ] 例：BFI-2-S-Jの場合、全30項目中15項目が逆転項目であることを確認

- [ ] **スコアリング規則の定義**
  - [ ] 通常項目のスコアリング方法が明確である（例：そのまま使用）
  - [ ] 逆転項目のスコアリング方法が明確である（例：6-raw で計算）
  - [ ] スコアリング式が正しいことをテストケースで検証している
  - [ ] 計算式をコメントとして実装に含めている

### 2.2 アンケート構造の設計

- [ ] **ページ分割の計画**
  - [ ] 各ページに表示する質問数を決定している
  - [ ] ページ数の妥当性を検討している（被験者の疲労、回答時間等）
  - [ ] 各ページのpage_itemsをドキュメント化している
  - [ ] 例：Q1-Q12（ページ1）、Q13-Q24（ページ2）、Q25-Q30（ページ3）

- [ ] **質問提示順序**
  - [ ] ランダム化の必要性を検討している
  - [ ] ランダム化する場合、random_order設定を実装している
  - [ ] シード値を記録して再現可能にしている（必要に応じて）

- [ ] **ファセット/ドメイン構造**
  - [ ] ドメイン（領域）の定義と項目割り当てが正確である
  - [ ] 各ドメイン内のファセット（下位次元）の定義が正確である
  - [ ] 各ファセットに割り当てられた項目数が文献と一致している
  - [ ] 例：BFI-2-S-Jの場合、E領域3ファセット×2項目=6項目

### 2.3 プラグイン選択（Likert尺度実装）

- [ ] **プラグインの選択**
  - [ ] jsPsych survey-likert プラグインを使用するか決定している
  - [ ] または別のカスタムプラグインを使用する場合、その正当性を確認している

- [ ] **survey-likert プラグインの設定**
  - [ ] `questions` 配列が正しく設定されている
  - [ ] `scale_label_left` と `scale_label_right` が設定されている
  - [ ] `required` 設定が適切である（通常 true）
  - [ ] `randomize_question_order` が必要に応じて設定されている

- [ ] **マウスオーバー（ホバー）テキストの実装**
  
  **実装パターンA: survey-likert でマウスオーバーなし**
  ```html
  <!-- 単純な選択肢のみ表示 -->
  - [ ] このパターンを選択した場合、理由を文書化している
  - [ ] ユーザビリティテストで選択肢理解度が確認されている
  ```

  **実装パターンB: カスタムCSS+HTML属性でマウスオーバーテキスト実装**
  ```html
  <!-- ホバーで詳細説明を表示 -->
  - [ ] CSS で .jspsych-survey-likert-opt label:hover::after を定義している
  - [ ] 各選択肢に対応するdata属性を追加している
  - [ ] content: attr(data-label) でテキストを表示している
  ```
  
  - [ ] 選択したパターンがドキュメント化されている
  - [ ] マウスオーバーテキストが使用可能な場合、その内容が明確である
  - [ ] モバイル対応を検討している（タッチデバイスではホバーが機能しない）

---

## 第III章: コード実装フェーズ

### 3.1 データ構造と変数定義

- [ ] **定数定義**
  - [ ] `REVERSED_ITEMS` 集合が正確に定義されている
    ```javascript
    const REVERSED_ITEMS = {1, 3, 7, 8, 10, 14, 17, 19, 20, 21, 24, 26, 27, 28, 30};
    ```
  - [ ] 各項目番号が文献と一致していることを確認している
  
  - [ ] `DOMAINS` 辞書が正確に定義されている
    ```javascript
    const DOMAINS = {
      'E': [1, 6, 11, 16, 21, 26],   // 外向性
      'A': [2, 7, 12, 17, 22, 27],   // 協調性
      'C': [3, 8, 13, 18, 23, 28],   // 勤勉性
      'N': [4, 9, 14, 19, 24, 29],   // 神経症傾向
      'O': [5, 10, 15, 20, 25, 30]   // 開放性
    };
    ```
  - [ ] 各ドメインに6項目ずつ割り当てられていることを確認
  - [ ] ドメイン内の逆転項目バランスが確認されている（例：各領域3逆転+3通常）

  - [ ] `FACETS` オブジェクトが定義されている（15ファセット×2項目）
  - [ ] `SURVEY2_DOMAIN_MEANS` と `SURVEY2_FACET_MEANS` が正確である
    - [ ] 比較対象の平均値の出典（論文、表番号）が明記されている
    - [ ] データの年号、サンプル属性が記録されている

### 3.2 スコアリング処理の実装

- [ ] **Q*_raw カラムの実装**
  - [ ] survey-likert プラグインの `response` オブジェクトから正確に抽出されている
  - [ ] 値が 1-5（またはその選択肢数）の範囲内であることを確認している
  - [ ] NULL値が適切に処理されている

- [ ] **逆転処理ロジック**
  ```javascript
  // 実装例
  const raw_index = responseValue;  // survey-likert から 0-4 が返される場合
  const raw = raw_index + 1;        // 1-5 に変換
  const scored = REVERSED_ITEMS.has(itemNum) ? (6 - raw) : raw;
  ```
  - [ ] `6 - raw` の計算式が正しいことをテストしている
  - [ ] 非逆転項目ではスコアが変わらないことを確認している
  - [ ] 逆転項目で期待通り反転されることをテストしている

- [ ] **Q*_scored カラムの検証**
  - [ ] 全項目について `scored` が 1-5 の範囲内であることをテストしている
  - [ ] テストケースで正転項目と逆転項目の処理が正確であることを確認している
  - [ ] 出力データで期待値と一致することを確認している

- [ ] **Q*_reversed フラグ**
  - [ ] 0（非逆転）または 1（逆転）のみを記録している
  - [ ] REVERSED_ITEMS との一致性をテストしている

- [ ] **Q*_item_number**
  - [ ] 各質問に対応する項目番号（1-30）が正確に記録されている
  - [ ] ドメイン・ファセット計算時に参照できるようになっている

### 3.3 集計処理の実装

- [ ] **ファセットスコア計算**
  ```javascript
  facetScore = (item1_scored + item2_scored) / 2
  ```
  - [ ] 各ファセットが2つの項目で構成されていることを確認している
  - [ ] 平均計算が正確であることを複数テストケースで検証している
  - [ ] NULL値の処理が適切である（片方だけ回答がない場合等）

- [ ] **ドメインスコア計算**
  ```javascript
  domainScore = (facet1 + facet2 + facet3) / 3
  // または
  domainScore = (item1_scored + item2_scored + ... + item6_scored) / 6
  ```
  - [ ] 各ドメインが3ファセットで構成されていることを確認している
  - [ ] 計算式が数学的に正確であることをテストしている
  - [ ] 結果が 1.0-5.0 の範囲内であることを確認している

- [ ] **設計上の特性の理解と文書化**
  - [ ] 各ドメインが1:1の逆転/通常項目バランスを持つことを理解している
  - [ ] 全項目が同じ値の場合、必ずドメインスコア=3.0になることを理解している（数学的に必然）
  - [ ] これがバグではなく設計上の特性であることをドキュメント化している
  - [ ] テストケースで「全て1」「全て3」「全て5」入力で3.0出力されることを検証している

### 3.4 データパイプ連携の実装

#### 3.4.1 jsPsych Pipe プラグイン設定

- [ ] **プラグイン読み込み**
  ```html
  <script src="https://unpkg.com/@jspsych-contrib/plugin-pipe"></script>
  ```
  - [ ] CDNリンクが正しく読み込まれている
  - [ ] ネットワークエラーが発生していないことをブラウザコンソールで確認している

- [ ] **実験ID設定**
  - [ ] OSF (Open Science Framework) に実験プロジェクトが作成されている
  - [ ] `experiment_id` が OSF プロジェクトと一致している
  - [ ] 実験IDをコメントに記録している

- [ ] **動作確認**
  - [ ] `action: "save"` で HTTP 201（Created）が返ることを確認している
  - [ ] OSF上にデータファイルが作成されることを確認している
  - [ ] ネットワークの遅延環境で動作することを確認している

#### 3.4.2 CSV生成と保存

- [ ] **CSV出力フォーマットの確認**
  ```javascript
  data_string: () => jsPsych.data.get().csv()
  ```
  - [ ] `jsPsych.data.get()` がすべてのトライアルを収集している
  - [ ] `.csv()` メソッドが正しくCSV形式で出力している
  - [ ] ダブルクォートのエスケープが適切である

- [ ] **除外列の処理**
  - [ ] `response` 列（JSON形式）が除外されている理由を確認している
  - [ ] `stimulus` 列（HTMLテンプレート）が除外されている理由を確認している
  - [ ] 他に除外すべき列がないか確認している

- [ ] **ファイル命名**
  ```javascript
  filename: `${subjectId}.csv`
  ```
  - [ ] `subjectId` が被験者を一意に識別できることを確認している
  - [ ] ファイル名に特殊文字が含まれていないことを確認している
  - [ ] OSF上での重複を避けるために十分なユニークさがある

#### 3.4.3 データ記録のタイミング

- [ ] **記録タイミングチェック**
  - [ ] **デモグラフィック情報の記録タイミング:**
    ```javascript
    // デモグラフィック画面表示後、同意画面の前 or 後
    on_finish: (data) => {
      jsPsych.data.addProperties({
        age: data.response.age,
        gender: data.response.gender
      });
    }
    ```
    - [ ] 記録タイミングが定義されている
    - [ ] 全トライアルに正確に反映されることを確認している

  - [ ] **各質問ページの記録:**
    - [ ] 各ページ完了時に Q*_raw, Q*_scored, Q*_reversed, Q*_item_number が記録されている
    - [ ] ページをスキップしても完全な記録が残ることを確認している

  - [ ] **実験時間メタデータの記録:**
    ```javascript
    // 実験終了時
    start_timestamp: 1761570333404,  // 開始時刻
    start_time_jst: "2025/10/27 22:05:33",  // 日本標準時
    end_timestamp: endTime,          // 終了時刻
    end_time_jst: formatJst(new Date(endTime)),
    total_duration_ms: duration,     // ミリ秒
    total_duration_sec: duration/1000,  // 秒
    total_duration_min: duration/60000  // 分
    ```
    - [ ] 実験開始と終了の時刻が記録されている
    - [ ] タイムゾーンが統一されている（JST = 日本標準時）
    - [ ] 所要時間が複数形式で記録されている

- [ ] **記録漏れの確認**
  - [ ] 意図的にスキップされたページのデータが適切に処理されている
  - [ ] ブラウザ閉じ込みなどで中断した場合のデータ保存を確認している
  - [ ] 最後の保存トライアル（jsPsych Pipe）がチェーン内で確実に実行される

### 3.5 フィードバック表示の実装

#### 3.5.1 結果表示画面

- [ ] **フィードバック内容の決定**
  - [ ] フィードバック表示の倫理的側面を確認している
    - [ ] 参加者に有益な情報である
    - [ ] 誤解を招かない表現である
  - [ ] フィードバックの内容を legalレビューに通している（必要に応じて）

- [ ] **ドメインスコア表示**
  - [ ] 5つのドメイン（E, A, C, N, O）のスコアが表示されている
  - [ ] 参加者スコアと日本人平均値（SURVEY2_DOMAIN_MEANS）が並べて表示されている
  - [ ] スコア範囲（1.0-5.0）が明記されている
  - [ ] 各ドメインの説明（外向性など）が日本語で正確に表記されている

- [ ] **ファセットスコア表示**
  - [ ] 15のファセット（例：「E：社交性」）が表示されている
  - [ ] 各ファセットが2つの項目で構成されていることが理解できる表示である
  - [ ] ファセット名が日本語で一貫している

- [ ] **グラフの実装**

  **実装パターンA: レーダーチャート（推奨）**
  - [ ] Chart.js ライブラリが正しく読み込まれている
    ```html
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    ```
  - [ ] レーダーチャートが5軸（ドメイン）と15軸（ファセット）の2種類作成されている
  - [ ] 青色線：参加者のスコア、赤色線：日本人平均値
  - [ ] スケールが1-5に統一されている
  - [ ] 半透明の塗りつぶしでスコアが見やすくなっている
  - [ ] キャンバスサイズが親要素に合わせて調整されている
  - [ ] 既存チャートの破棄（destroy()）でメモリリーク防止

  **実装パターンB: 棒グラフ**
  - [ ] （代替案として検討する場合のみ）
  - [ ] 複数のドメイン/ファセットを並べて表示できている
  - [ ] 参加者値と平均値の比較が視認しやすい

  **実装パターンC: テーブルのみ**
  - [ ] （グラフなしで数値表のみの場合）
  - [ ] テーブルが見やすいフォーマットである
  - [ ] 列見出しが明確である

- [ ] **テーブルの実装**
  - [ ] HTMLテーブルが正しく生成されている
  - [ ] 列：「ファセット」「あなたのスコア」「日本人平均」
  - [ ] 数値が小数第2位まで表示されている
  - [ ] テーブルのシャドウやボーダーが見やすい

#### 3.5.2 フィードバック計算の検証

- [ ] **計算式の検証**
  - [ ] 参加者スコア計算式が実装済みスコアリング規則と同じである
  - [ ] 日本人平均値の取得が SURVEY2_DOMAIN_MEANS/FACET_MEANS から行われている
  - [ ] 平均値の年号、サンプル属性が正確である

- [ ] **数値の妥当性**
  - [ ] すべてのスコアが 1.0-5.0 範囲内である
  - [ ] 小数点以下の桁数が統一されている
  - [ ] 丸め込み方法が明記されている

- [ ] **フィードバック内容の倫理性**
  - [ ] 結果が判断的でない（例：「あなたは～な人です」は避ける）
  - [ ] 参加者に対して有益な解釈を提供している
  - [ ] 民族的偏見や性差別などを含まない
  - [ ] 倫理審査委員会から承認された表現を使用している

---

## 第IV章: テスト・検証フェーズ

### 4.1 ユニットテスト（単体テスト）

- [ ] **逆転項目処理のテスト**
  ```javascript
  // テストケース1: 通常項目
  input: raw=5, itemNum=2 (非逆転)
  expected: scored=5
  actual: _______
  ✓/✗
  
  // テストケース2: 逆転項目
  input: raw=2, itemNum=1 (逆転)
  expected: scored=4 (6-2=4)
  actual: _______
  ✓/✗
  
  // テストケース3: 極値
  input: raw=1, itemNum=7 (逆転)
  expected: scored=5 (6-1=5)
  actual: _______
  ✓/✗
  ```
  - [ ] 全テストケースがパスしている

- [ ] **スコアリング計算のテスト**
  ```javascript
  // 全て1の場合
  E領域6項目全て1 → E領域スコア = 3.0
  
  // 全て5の場合
  A領域6項目全て5 → A領域スコア = 3.0
  
  // 混合の場合
  C領域: [5, 1, 5, 1, 5, 1] → 平均 = 3.0
  ```
  - [ ] 全テストケースがパスしている
  - [ ] 数式の正確性が確認されている

- [ ] **ファセット計算のテスト**
  ```javascript
  E：社交性 = (Q1 + Q16) / 2
  input: Q1_scored=4, Q16_scored=5
  expected: 4.5
  actual: _______
  ✓/✗
  ```
  - [ ] 全15ファセットについてテストしている

- [ ] **ドメイン計算のテスト**
  ```javascript
  E領域 = (E社交 + E自己主張 + E活力) / 3
  input: 社交=3.5, 自己主張=4.0, 活力=3.5
  expected: 3.667
  actual: _______
  ✓/✗
  ```
  - [ ] 全5ドメインについてテストしている

### 4.2 統合テスト（エンドツーエンド）

- [ ] **ブラウザテスト環境**
  - [ ] Chrome（最新版）で動作確認
  - [ ] Safari（最新版）で動作確認
  - [ ] Firefox（最新版）で動作確認
  - [ ] Edge（最新版）で動作確認
  - [ ] モバイルブラウザ（iOS Safari, Chrome Android）で動作確認

- [ ] **完全な回答フロー**
  - [ ] 同意画面 → デモグラフィック → Q1-12 → Q13-24 → Q25-30 → 結果表示 → 終了
  - [ ] 全ステップで意図通りのデータが収集されている
  - [ ] ページ遷移が正常に機能している

- [ ] **データ完全性テスト**
  ```
  結果CSVの検証項目：
  - [ ] 列数が 136 列である（メタデータ16 + 質問120）
  - [ ] 行数がトライアル数と一致している
  - [ ] Q*_raw が 1-5 の値のみを含む
  - [ ] Q*_scored が 1-5 の値のみを含む
  - [ ] Q*_reversed が 0 or 1 のみを含む
  - [ ] Q*_item_number が 1-30 のみを含む
  - [ ] 必須フィールドに NULL がない
  ```
  - [ ] 検証がパスしている

- [ ] **実験時間測定**
  - [ ] 5分-10分の回答所要時間でテストしている
  - [ ] 実験開始から終了までのタイムスタンプが正確に記録されている
  - [ ] start_time_jst から total_duration を逆算できる

- [ ] **データパイプ連携テスト**
  - [ ] OSFに登録した実験IDでテスト投稿している
  - [ ] HTTP 201レスポンスが確認されている
  - [ ] OSF上にファイルが作成されていることを確認している
  - [ ] ファイル内容がブラウザ側データと一致していることを確認している
  - [ ] ネットワーク遅延環境でも正常に保存されることを確認している

- [ ] **グラフ描画テスト**
  - [ ] ドメイン用レーダーチャート（5軸）が正しく描画される
  - [ ] ファセット用レーダーチャート（15軸）が正しく描画される
  - [ ] 青色線（参加者）と赤色線（平均値）の両方が表示される
  - [ ] スケール（1-5）が正しく設定されている
  - [ ] キャンバスサイズがウィンドウリサイズに対応している

### 4.3 ユーザビリティテスト

- [ ] **参加者体験のテスト**
  - [ ] 対象の年代・属性と同程度の3-5名でテストしている
  - [ ] 質問文が理解しやすいことを確認している
  - [ ] 選択肢の定義（Likert尺度のラベル）が明確であることを確認している
  - [ ] 進捗バーが適切に機能していることを確認している
  - [ ] 回答時間が想定範囲（5-10分など）であることを確認している
  - [ ] 参加者から改善提案を収集している

- [ ] **アクセシビリティテスト**
  - [ ] スクリーンリーダー（NVDA, JAWS等）で読み上げ可能か確認
  - [ ] キーボードのみで操作可能か確認
  - [ ] テキストコントラストが十分であることを確認
  - [ ] フォントサイズが小さすぎないことを確認

- [ ] **モバイル対応テスト**
  - [ ] スマートフォン（iPhone, Android）で表示・操作可能か確認
  - [ ] タッチ操作で問題なく回答できることを確認
  - [ ] ホバーテキスト（マウスオーバー）がモバイルで機能しないことを理解している
  - [ ] モバイルでの回答時間が過剰に長くないことを確認

### 4.4 ストレステスト

- [ ] **同時接続テスト**
  - [ ] 複数ユーザーの同時実行で正常に機能することを確認
  - [ ] データパイプへのファイル保存が重複しないことを確認
  - [ ] ネットワーク遅延が発生した場合の動作を確認

- [ ] **ロングランテスト**
  - [ ] 異なる参加者IDで10-20回連続実行している
  - [ ] メモリリークが発生していないことを確認している（ブラウザ開発者ツール）
  - [ ] チャートの破棄（destroy()）が正常に機能していることを確認している

---

## 第V章: ドキュメント作成フェーズ

### 5.1 技術ドキュメント

- [ ] **Code Dictionary（コード辞書）**
  - [ ] 主要な関数をドキュメント化している
    - [ ] `collectResponses()`: 回答収集
    - [ ] `computeSummary()`: スコア計算
    - [ ] `generateAnalysisCsv()`: CSV生成
    - [ ] `createSaveTrial()`: データ保存
  - [ ] 各関数の入力・出力・処理内容が明記されている
  - [ ] 関数内のコメントが日本語・英語で記載されている

- [ ] **Data Dictionary（データ辞書）**
  - [ ] 全136列の説明が含まれている
  - [ ] **メタデータ列（16列）:**
    - [ ] page_number: ページ番号
    - [ ] page_items: 各ページの質問項目
    - [ ] rt: 応答時間（ミリ秒）
    - [ ] trial_type: トライアルタイプ
    - [ ] time_elapsed: 経過時間
    - [ ] subject_id: 被験者ID
    - [ ] age, gender: デモグラフィック
    - [ ] start_timestamp, start_time_jst: 開始時刻
    - [ ] end_timestamp, end_time_jst: 終了時刻
    - [ ] total_duration_*: 所要時間
    - [ ] browser, os, user_agent: 環境情報
    - [ ] plugin_version: プラグインバージョン
    - [ ] question_order: 質問呈示順序

  - [ ] **質問データ列（120列）:**
    - [ ] Q{1-30}_raw: ユーザー生回答（1-5）
    - [ ] Q{1-30}_scored: スコアリング後（1-5）
    - [ ] Q{1-30}_reversed: 逆転フラグ（0/1）
    - [ ] Q{1-30}_item_number: 項目番号（1-30）

  - [ ] **各列の詳細:**
    - [ ] データ型（整数、テキスト等）
    - [ ] 値の範囲
    - [ ] NULL値の意味
    - [ ] 計算方法（該当する場合）

  - [ ] **ドメイン・ファセット構造:**
    - [ ] 5つのドメイン定義と項目割り当て
    - [ ] 15のファセット定義と項目割り当て
    - [ ] 逆転項目リスト

- [ ] **Implementation Guide（実装ガイド）**
  - [ ] 本実装に至った経緯と問題解決プロセスが記載されている
  - [ ] 選択肢数の決定理由
  - [ ] 逆転項目処理の検証プロセス
  - [ ] リッカートプラグイン選択の理由
  - [ ] データパイプ連携設定の手順

### 5.2 分析者向けドキュメント

- [ ] **Analysis Guide（分析ガイド）**
  - [ ] データの読み込み方法（R, Python, SPSS等言語別）
  - [ ] 逆転項目処理の確認方法
  - [ ] スコアの再計算方法
  - [ ] ファセット・ドメイン平均の計算手順
  - [ ] 外れ値・欠損値の処理方法

- [ ] **Q&A Document（よくある質問）**
  - [ ] Q: 「Q*_raw と Q*_scored が同じ値なのはなぜ？」
    - A: 通常項目（逆転なし）では変わりません。Q7など逆転項目は異なります。
  - [ ] Q: 「全項目が同じ値のときドメインスコアが3.0なのはなぜ？」
    - A: BFI-2-S-Jは逆転/通常項目が1:1バランスを持つため、数学的に必然です。
  - [ ] Q: 「欠損データがあるときの計算方法は？」
    - A: [具体的な処理方法を記載]

### 5.3 倫理・同意関連ドキュメント

- [ ] **Informed Consent Statement（インフォームドコンセント）**
  - [ ] 最終版が倫理審査承認と一致している
  - [ ] 参加者が画面で確認・同意できる形式である
  - [ ] 同意オプション（同意する/同意しない）が実装されている

- [ ] **Privacy Policy（プライバシーポリシー）**
  - [ ] データ保管場所（OSF等）が明記されている
  - [ ] 保管期間が明記されている
  - [ ] データアクセス権限が明記されている
  - [ ] 削除方法が明記されている

- [ ] **IRB Approval Documentation（倫理審査承認書）**
  - [ ] 承認番号がドキュメント化されている
  - [ ] 承認期限がドキュメント化されている
  - [ ] 承認書のコピーが保管されている

---

## 第VI章: デプロイ前最終確認フェーズ

### 6.1 本番環境への移行準備

- [ ] **ホスティング環境**
  - [ ] ウェブサーバーが HTTPS に対応している
  - [ ] サーバーが jsPsych ファイルを正しく配信している
  - [ ] CDN（Chart.js, plugin-pipe等）へのアクセスが許可されている
  - [ ] クロスオリジン問題（CORS）がないことを確認している

- [ ] **OSF設定**
  - [ ] OSF実験プロジェクトが本番環境用に設定されている
  - [ ] データ保存先フォルダが指定されている
  - [ ] アクセス権限が適切に設定されている
  - [ ] 共同研究者のアクセス権限が設定されている

- [ ] **ファイル構成**
  - [ ] `bfi2sj.html` が最新版である
  - [ ] 全スクリプトライブラリが読み込まれている
  - [ ] CSSファイルが正しくリンクされている
  - [ ] 不要なテストコード・デバッグコードが削除されている

### 6.2 セキュリティ確認

- [ ] **データセキュリティ**
  - [ ] 個人情報（メールアドレス等）がCSVに含まれていない
  - [ ] 生IPアドレスが記録されていない（user_agentのみ）
  - [ ] 被験者IDが被験者を再特定できないようになっている

- [ ] **HTTPS/SSL**
  - [ ] サイトが HTTPS で配信されている
  - [ ] SSL証明書が有効である

- [ ] **スクリプトセキュリティ**
  - [ ] jsPsychライブラリが公式CDNから読み込まれている
  - [ ] サードパーティスクリプトの信頼性を確認している
  - [ ] インラインスクリプトが最小限である

### 6.3 ブラウザコンソール確認

- [ ] **エラー・警告メッセージ**
  - [ ] JavaScriptエラーがないことをブラウザコンソールで確認
  - [ ] 警告メッセージがないか確認
  - [ ] CORSエラーがないことを確認
  - [ ] 404エラーがないことを確認

- [ ] **ネットワークタブ**
  - [ ] すべてのリソース（js, css, fonts等）がHTTP 200で読み込まれている
  - [ ] 失敗しているリクエストがないことを確認
  - [ ] データパイプへのPOSTリクエストが HTTP 201 を返していることを確認

### 6.4 最終チェックリスト（Go/No-Go判定）

#### チェック項目の集約

| 項目 | 対象セクション | ステータス |
|------|--------------|----------|
| 倫理審査承認 | 1.1 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| 選択肢定義 | 2.1 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| 逆転項目確認 | 2.1 / 3.2 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| スコアリング検証 | 3.2 / 4.1 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| データパイプ設定 | 3.4 / 4.2 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| フィードバック実装 | 3.5 / 4.2 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| ユニットテスト | 4.1 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| 統合テスト | 4.2 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| ユーザビリティテスト | 4.3 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| Data Dictionary作成 | 5.1 | ☐ 完了 / ☐ 対応中 / ☐ NG |
| セキュリティ確認 | 6.2 | ☐ 完了 / ☐ 対応中 / ☐ NG |

#### デプロイ判定

- [ ] **Go条件:**
  - 上記全項目が「完了」状態
  - コンソールエラーがない
  - テスト実行で期待通りのデータが生成されている
  - 倫理審査承認を取得している

- [ ] **No-Go条件:**
  - 「NG」状態の項目がある場合
  - テスト失敗がある場合
  - セキュリティ脆弱性がある場合
  - 倫理審査保留中の場合

**デプロイ判定:** ☐ Go ☐ No-Go  
判定日: _________  
判定者: _________  
コメント: _________________

---

## 第VII章: デプロイ後フェーズ

### 7.1 本番環境の監視

- [ ] **データ品質監視**
  - [ ] 初日のデータを手動確認している
  - [ ] 異常なパターン（全て同じ値等）を監視している
  - [ ] 欠損率が想定範囲内であることを確認している

- [ ] **エラーモニタリング**
  - [ ] ブラウザコンソールエラーを定期的に確認している
  - [ ] サーバーログを監視している
  - [ ] データパイプのエラーレート（HTTP非200）を確認している

- [ ] **ユーザーサポート**
  - [ ] 参加者からの問い合わせに対応する体制が整っている
  - [ ] よくある問題への対応方法をドキュメント化している
  - [ ] ホットラインが実装されている場合、応答体制を確認

### 7.2 トラブルシューティング

- [ ] **よくある問題と対応**
  - [ ] 「データが保存されていない」→ OSFへのアクセス権限確認等
  - [ ] 「グラフが表示されない」→ Chart.js読み込み確認等
  - [ ] 「計算結果がおかしい」→ 逆転項目処理確認等
  - [ ] 各問題の診断フロー図を作成している

### 7.3 データ品質確保

- [ ] **定期的なデータ検査**
  - [ ] 週単位で到達したデータを確認
  - [ ] 統計的な異常値検出
  - [ ] 回答パターンの異常検出（例：全て同じ値）

- [ ] **異常データの対応**
  - [ ] 異常データの定義が明確である
  - [ ] 異常データの処理方法が事前に決定されている
  - [ ] 異常データが分析から除外されるか否かを判定する基準がある

---

## 第VIII章: 柔軟性と拡張性

### 8.1 選択肢数の変更への対応

**標準実装: 5段階Likert尺度**
```javascript
// 現在の実装
scale_label_left: "全くあてはまらない",
scale_label_right: "とてもよくあてはまる",
// 内部的には 1-5 の値を使用
```

**7段階に変更する場合:**
- [ ] Likert尺度を 1-7 に変更
- [ ] スコアリング式を調整（例：逆転時に `8 - raw` に変更）
- [ ] 平均値比較データを 7段階対応版に変更
- [ ] グラフのスケール（suggestedMax）を7に変更
- [ ] テストケースを全て再実行
- [ ] ドメイン・ファセット平均の計算は変わらず（平均値のため）

**二者択一に変更する場合:**
- [ ] trial_type を "survey-multi-choice" に変更
- [ ] "Yes/No" 等の選択肢に対応
- [ ] スコアリングロジックを 0/1 または 1/2 に調整
- [ ] 逆転項目の定義を見直し
- [ ] フィードバックの解釈を調整

### 8.2 逆転項目パターンの変更への対応

**現在: 1:1バランス（各ドメイン3逆転+3通常）**
- ドメインスコア計算時に3.0への収束特性あり

**異なるパターン例1: 全項目通常（逆転なし）**
- [ ] `REVERSED_ITEMS` を空集合に変更
- [ ] スコアリングロジックで常に `scored = raw` となる
- [ ] テストケース修正（全て1なら1.0、全て5なら5.0になる）
- [ ] この設計のメリット・デメリットを文書化

**異なるパターン例2: 全項目逆転**
- [ ] `REVERSED_ITEMS` に全30項目を追加
- [ ] スコアリングで常に逆転する
- [ ] テストケース修正
- [ ] 元のスケールとの対応関係を文書化

**異なるパターン例3: ドメイン毎に異なるバランス**
- [ ] 例：E領域は5逆転1通常、A領域は3逆転3通常等
- [ ] スコアリングロジックはそのままで対応可能
- [ ] ドメイン平均計算で結果が異なることを理解
- [ ] 各ドメインの特性を説明ドキュメント化

### 8.3 プラグイン変更への対応

**現在: survey-likert プラグイン**
- マウスオーバーテキスト対応

**代替案1: カスタム HTML + CSS**
- [ ] survey-likert の代わりに html-slider-response 使用
- [ ] スライダーのスタイルをカスタマイズ
- [ ] スライダーの値をテキストで表示
- [ ] マウスオーバーテキストの実装が異なる

**代替案2: 画像ボタン**
- [ ] 各選択肢を画像ボタンに変更
- [ ] ボタンホバー時にツールチップ表示
- [ ] 視覚的なフィードバックを強化
- [ ] スマートフォンでのタッチ対応

**代替案3: スライダー + 数字表示**
- [ ] survey-slider プラグイン使用
- [ ] リアルタイムに数字が更新される
- [ ] より直感的な操作感

### 8.4 フィードバック表示方法の変更への対応

**現在: レーダーチャート + テーブル**
```
レーダーチャート（5軸ドメイン）
レーダーチャート（15軸ファセット）
テーブル表示
```

**代替案1: 棒グラフのみ**
- [ ] Chart.js bar chart を使用
- [ ] 参加者値と平均値を並べて表示
- [ ] より理解しやすい場合がある

**代替案2: テーブルのみ（グラフなし）**
- [ ] グラフ描画処理を削除
- [ ] HTMLテーブルのスタイルをより充実
- [ ] 容量削減、高速表示化

**代替案3: インタラクティブなダッシュボード**
- [ ] D3.js等で複雑なビジュアライゼーション
- [ ] ドメイン/ファセットを切り替え可能
- [ ] より高度なインタラクション

### 8.5 記録内容の変更への対応

**追加すべき情報の検討**
- [ ] 画面サイズ/解像度（user-agent に含まれるが、より詳細に）
- [ ] ローカルタイムゾーン（現在 JST のみ）
- [ ] デバイスタイプ（モバイル/PC の明示的判定）
- [ ] ネットワーク速度（遅延時間）
- [ ] 気分スコア（回答前後の主観的評価）

**記録タイミングの変更**
- [ ] 各ページごとのデータパイプ保存（リアルタイム）
  - メリット：中断時のデータ損失防止
  - デメリット：OSFへのリクエスト増加
- [ ] 定期的な自動保存（例：5分毎）
- [ ] 最後のみ保存（現在の実装）

---

## 付録A: トラブルシューティング早見表

| 問題 | 考えられる原因 | 確認方法 | 対応方法 |
|------|------------|--------|---------|
| Q*_scored がおかしい | 逆転項目処理エラー | Q*_reversed と Q*_raw から手計算で確認 | スコアリング式を確認、テストケース実行 |
| グラフが表示されない | Chart.js 未読み込み | ブラウザコンソール確認 | CDN リンク確認、キャッシュ削除 |
| ドメインスコアが全て3.0 | バランスのとれた逆転設計 | REVERSED_ITEMS の1:1バランス確認 | 仕様理解、テストケース確認 |
| データが保存されていない | OSF 認証エラー | Network タブで HTTP ステータス確認 | experiment_id 確認、OSF アクセス権限確認 |
| モバイルでホバーが機能しない | 仕様の通り | タッチデバイスで確認 | ホバーなしでも理解できるUI設計 |

---

## 付録B: チェックリスト実行例

```
【BFI-2-S-J 日本語版デプロイ】
実行日: 2025/10/27
実行者: 山田太郎

第I章: 事前準備フェーズ ...................... ✓ 完了
  - 倫理審査承認（承認番号: XXX-2025-001）
  - インフォームドコンセント確定
  - GDPR対応確認

第II章: 技術仕様設定フェーズ ............... ✓ 完了
  - 5段階Likert尺度確定
  - 逆転項目15個特定
  - 5ドメイン×3ファセット=15ファセット構造確定
  - survey-likert + hover text 実装決定

第III章: コード実装フェーズ ................ ✓ 完了
  - REVERSED_ITEMS定数確認
  - スコアリング式実装
  - CSV生成ロジック実装
  - データパイプ連携実装

第IV章: テスト・検証フェーズ .............. ✓ 完了
  - ユニットテスト 全24項目 ✓
  - 統合テスト（4ブラウザ） ✓
  - ユーザビリティテスト（3名） ✓
  - ストレステスト（20回連続実行） ✓

第V章: ドキュメント作成フェーズ ........... ✓ 完了
  - CSV_DATA_DICTIONARY.md
  - IMPLEMENTATION_STATUS.md
  - Analysis_Guide.md

第VI章: デプロイ前最終確認フェーズ ........ ✓ 完了
  - ホスティング環境確認
  - OSF設定完了
  - セキュリティ確認
  - コンソールエラーなし

第VII章: デプロイ後フェーズ ............... ⏳ 進行中
  - 初日データ確認予定: 2025/10/28

デプロイ判定: ✓ Go
判定コメント: 全チェックリスト完了。本番運用開始。
```

---

## 付録C: 参考資料

- BFI-2-S-J 原論文: 吉野伸哉・下司忠大・橋本泰央・上野雄己・三枝高大・小塩真司 (2026). 心理学研究, https://doi.org/10.4992/jjpsy.96.24214
- jsPsych 公式ドキュメント: https://www.jspsych.org/
- OSF 公式ドキュメント: https://osf.io/
- Chart.js ドキュメント: https://www.chartjs.org/
- GDPR コンプライアンス: https://gdpr-info.eu/

---

**文書情報:**
- **版: 1.0**
- **作成日: 2025年10月27日**
- **作成者: AI Assistant**
- **参考実装: BFI-2-S-J (bfi2sj.html)**
- **最終テスト実行: 2025年10月27日**
